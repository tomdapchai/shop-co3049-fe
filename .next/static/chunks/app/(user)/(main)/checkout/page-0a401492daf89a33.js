(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9523],{9398:(e,r,t)=>{Promise.resolve().then(t.bind(t,52969))},52969:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>h});var a=t(95155);t(12115);var o=t(61584),c=t(80839),s=t(29602),d=t(48173),n=t.n(d),l=t(5565),i=t(47647),u=t(70197),p=t(20241),m=t(70874),g=t(76046);function h(){let{cart:e,clearCart:r,clearCartUser:t}=(0,o._)(),{userId:d,isLoggedIn:h}=(0,c.A)(),{toast:f}=(0,p.dj)(),x=(0,g.useRouter)(),y=()=>e.reduce((e,r)=>e+r.productPrice*r.quantity,0),A=async a=>{let{streetAddress:o,city:c,province:s,...n}=a;console.log("Order submitted:",{userId:d,...n,address:"".concat(o,", ").concat(c,", ").concat(s),products:e,total:y()}),await (0,m.fS)({userId:h?d:null,...n,address:"".concat(o,", ").concat(c,", ").concat(s),products:e,total:y()}).then(e=>{if("error"in e)f({title:"Error",description:"An error occurred while placing the order.",variant:"destructive"});else{f({title:"Order placed successfully!",description:"We've received your order and will process it shortly."});let r=e.orderId;x.push("/success/".concat(r))}}).finally(()=>{h?t():r()})};return(0,a.jsxs)("div",{id:"checkout-container",className:"w-full h-full flex flex-col space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col w-full h-[400px] relative justify-center items-center overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-[url('/images/banner.jpg')] bg-cover bg-center bg-no-repeat filter blur-sm"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-white/10"}),(0,a.jsx)(l.default,{src:i.A,alt:"Furniro",priority:!0,className:"z-10"}),(0,a.jsx)("h1",{className:"relative z-10 font-bold text-6xl text-sub",children:"Checkout"})]}),(0,a.jsx)("div",{className:"bg-white rounded w-full px-8 pt-6 pb-8 space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"w-full md:px-12 md:py-12",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold mb-6",children:"Billing details"}),(0,a.jsx)(u.A,{onSubmit:A})]}),(0,a.jsxs)("div",{className:"w-full px-4 sm:px-6 md:px-24 py-8 sm:py-12 md:py-24 bg-white rounded-md md:max-w-3xl",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 mb-4",children:[(0,a.jsx)("div",{className:"text-left",children:(0,a.jsx)("h2",{className:"text-lg sm:text-xl font-bold",children:"Product"})}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)("h2",{className:"text-lg sm:text-xl font-bold",children:"Subtotal"})})]}),e.map((e,r)=>(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-gray-400 mb-1 sm:mb-0",children:[e.productName,(0,a.jsxs)("span",{className:"px-2 text-sm font-normal text-gray-700",children:["x ",e.quantity]})]}),(0,a.jsx)("span",{className:"text-gray-700 font-medium",children:(0,s.$g)(e.productPrice*e.quantity)})]},r)),(0,a.jsxs)("div",{className:"flex justify-between pt-2",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Total"}),(0,a.jsx)("span",{className:"text-yellow-500 font-extrabold text-lg",children:(0,s.$g)(y())})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-4",children:["Your personal data will be used to support your experience throughout this website, to manage access to your account, and for other purposes described in our"," ",(0,a.jsx)(n(),{href:"/privacy-policy",className:"underline font-extrabold",children:"privacy policy"}),"."]})]})]})})]})}},61584:(e,r,t)=>{"use strict";t.d(r,{_:()=>i,default:()=>p});var a=t(95155),o=t(12115),c=t(20241),s=t(80839),d=t(35408);let n=(0,o.createContext)(void 0),l={quantity:1},i=()=>{let e=(0,o.useContext)(n);if(!e)throw Error("useCart must be used within a CartProvider");return e},u="cart",p=e=>{let{children:r}=e,{isLoggedIn:t,user:i}=(0,s.A)(),[p,m]=(0,o.useState)([]),[g,h]=(0,o.useState)(!1),{toast:f}=(0,c.dj)();return((0,o.useEffect)(()=>{if(!g)try{let e=localStorage.getItem(u);if(e){let r=JSON.parse(e);Array.isArray(r)&&m(r)}}catch(e){console.error("Error loading cart from localStorage:",e)}finally{h(!0)}},[]),(0,o.useEffect)(()=>{if(!g)return;let e=setTimeout(()=>{try{localStorage.setItem(u,JSON.stringify(p))}catch(e){console.error("Error saving cart to localStorage:",e),f({title:"Error saving cart",description:"Your cart changes might not persist after page refresh",variant:"destructive"})}t&&(null==i?void 0:i.userId)&&p.length>0&&(0,d.iH)(i.userId.toString(),p).catch(e=>{console.error("Error updating cart in backend:",e),f({title:"Error updating cart",description:"Failed to sync cart with server",variant:"destructive"})})},300);return()=>clearTimeout(e)},[p,g,t,null==i?void 0:i.userId]),(0,o.useEffect)(()=>{g&&t&&(null==i?void 0:i.userId)&&Array.isArray(i.cart)&&i.cart.length>0&&m(e=>{let r=new Map(e.map(e=>["".concat(e.productId,"-").concat(e.color,"-").concat(e.size),e])),t=[...e],a=!1;return i.cart.forEach(e=>{let o="".concat(e.productId,"-").concat(e.color,"-").concat(e.size),c=r.get(o);if(c){if(c.quantity!==e.quantity){let r=t.findIndex(r=>r.productId===e.productId&&r.color===e.color&&r.size===e.size);-1!==r&&(t[r]={...c,quantity:c.quantity+e.quantity},a=!0)}}else t.push(e),a=!0}),a?t:e})},[g,t,null==i?void 0:i.userId,null==i?void 0:i.cart]),g)?(0,a.jsx)(n.Provider,{value:{test:"test",cart:p,addToCart:e=>{try{if(!e.productId)throw Error("Product ID is required");m(r=>{let t=r.findIndex(r=>r.productId===e.productId&&r.color===e.color&&r.size===e.size);if(t>=0){let a=[...r];return a[t]={...a[t],quantity:a[t].quantity+(e.quantity||l.quantity)},a}{let t={...l,...e,productId:e.productId,productName:e.productName,productImage:e.productImage,productPrice:e.productPrice,size:e.size,color:e.color};return[...r,t]}}),f({title:"Item added to cart",description:"Item added to cart successfully",variant:"default",className:"bg-sub border-none"})}catch(e){console.error("Error adding item to cart:",e),f({title:"Error adding item to cart",description:"An error occurred while adding item to cart",variant:"destructive"})}},removeFromCart:e=>{try{m(r=>{let t=[...r];return t.splice(e,1),t}),f({title:"Item removed from cart",description:"Item removed from cart successfully",variant:"destructive"})}catch(e){console.error("Error removing item from cart:",e)}},updateQuantity:(e,r)=>{try{m(t=>t.map((t,a)=>e===a?{...t,quantity:Math.max(1,r)}:t)),f({title:"Quantity updated",description:"Quantity updated successfully",variant:"default",className:"bg-main border-none"})}catch(e){console.error("Error updating quantity:",e)}},updateOrderDetails:(e,r)=>{try{m(t=>t.map(t=>t.productId===e?{...t,...r}:t))}catch(e){console.error("Error updating order details:",e)}},clearCart:()=>{try{m([]),localStorage.removeItem(u)}catch(e){console.error("Error clearing cart:",e)}},clearCartUser:()=>{try{m([]),localStorage.removeItem(u),t&&i&&(0,d.iH)(i.userId.toString(),[])}catch(e){console.error("Error clearing cart:",e)}},getCartTotal:()=>p.reduce((e,r)=>e+r.quantity,0)},children:r}):null}},76046:(e,r,t)=>{"use strict";var a=t(66658);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},70874:(e,r,t)=>{"use strict";t.d(r,{Kv:()=>n,RL:()=>s,Vd:()=>c,fS:()=>d,xo:()=>o});var a=t(46820);let o=async e=>{try{let r=await a.A.get("api/order/routes.php?userId=".concat(e));console.log("Backend Response:",r.data);let t=[];return r.data.length>0&&(t=r.data.map(e=>({orderId:e.orderId,products:e.products.map(e=>({productId:e.productId,quantity:e.quantity,color:e.color,size:e.size,productName:e.productName,productImage:e.productImage,productPrice:e.productPrice})),status:e.status,createdAt:e.createdAt,completedAt:e.completedAt,userId:e.userId,phone_number:e.phone_number,address:e.address,total:Number(e.total),name:e.name}))),t}catch(e){return console.error("Error fetching orders:",e),{error:"Error fetching orders"}}},c=async()=>{try{let e=await a.A.get("api/order/routes.php");return console.log("Backend Response:",e.data),e.data.map(e=>({orderId:e.orderId,products:e.products.map(e=>({productId:e.productId,quantity:e.quantity,color:e.color,size:e.size,productName:e.productName,productImage:e.productImage,productPrice:e.productPrice})),status:e.status,createdAt:e.createdAt,completedAt:e.completedAt,userId:e.userId,phone_number:e.phone_number,address:e.address,total:Number(e.total),name:e.name}))}catch(e){return console.log("Error fetching orders:",e),{error:"Error fetching orders"}}},s=async e=>{try{let r=await a.A.get("api/order/routes.php?orderId=".concat(e));return console.log("Backend Response:",r.data),{orderId:r.data.orderId,products:r.data.products.map(e=>({productId:e.productId,quantity:e.quantity,color:e.color,size:e.size,productName:e.productName,productImage:e.productImage,productPrice:e.productPrice})),status:r.data.status,createdAt:r.data.createdAt,completedAt:r.data.completedAt,userId:r.data.userId,phone_number:r.data.phone_number,address:r.data.address,total:Number(r.data.total),name:r.data.name}}catch(e){return console.log("Error fetching orders:",e),{error:"Error fetching orders"}}},d=async e=>{try{let r=await a.A.post("api/order/routes.php",e);return console.log("Backend Response:",r.data),{orderId:r.data.orderId}}catch(e){return console.log("Error creating order:",e),{error:"Error creating order"}}},n=async(e,r)=>{try{let t=await a.A.put("api/order/routes.php?orderId=".concat(e,"&status=").concat(r));return console.log("Backend Response:",t.data),{message:t.data.message}}catch(e){return console.log("Error updating order status:",e),{error:"Error updating order status"}}}},47647:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a={src:"/_next/static/media/logo.b4f15a9b.png",height:33,width:50,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAGFBMVEW3jS5MaXG3jC65ji65jS+5ji6ziy+4jS7/zpEHAAAACHRSTlNPAG5gLpQbgWXoK4oAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAoSURBVHicFcexEQAwDAKxx4C9/8a5qBMSWSS0Z7pCjD0WuWnnAg1/DwmAAHVrUTobAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5}}},e=>{var r=r=>e(e.s=r);e.O(0,[2651,1345,1359,8173,7518,6395,7872,7369,8441,1517,7358],()=>r(9398)),_N_E=e.O()}]);