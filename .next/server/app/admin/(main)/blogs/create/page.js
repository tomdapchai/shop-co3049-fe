(()=>{var e={};e.id=4382,e.ids=[4382],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},21820:e=>{"use strict";e.exports=require("os")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},83997:e=>{"use strict";e.exports=require("tty")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},33737:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(70260),o=r(28203),n=r(25155),l=r.n(n),a=r(67292),i={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>a[e]);r.d(t,i);let c=["",{children:["admin",{children:["(main)",{children:["blogs",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,34584)),"W:\\web\\shop-co3049-fe\\app\\admin\\(main)\\blogs\\create\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9540)),"W:\\web\\shop-co3049-fe\\app\\admin\\(main)\\layout.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,19611)),"W:\\web\\shop-co3049-fe\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["W:\\web\\shop-co3049-fe\\app\\admin\\(main)\\blogs\\create\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/admin/(main)/blogs/create/page",pathname:"/admin/blogs/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},31894:(e,t,r)=>{Promise.resolve().then(r.bind(r,34584))},55454:(e,t,r)=>{Promise.resolve().then(r.bind(r,36852))},36852:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>I});var s=r(45512),o=r(58009),n=r(6868),l=r(81914),a=r(87021),i=r(48859),c=r(71965),d=r(666),u=r(70801),p=r(27071),g=r(94727),h=r(25409),m=r(26288),x=r(18295),b=r(80401),f=r(59462),v=r(45103),j=r(29695),w=r(89850),y=r(48052);function I(){let[e,t]=(0,o.useState)([]),[r,I]=(0,o.useState)(),[E,$]=(0,o.useState)(""),[N,A]=(0,o.useState)(!1),{toast:C}=(0,u.dj)(),P=(0,n.mN)({resolver:(0,l.u)(y.Em),defaultValues:{title:"",blogId:"",content:"",tags:[]}}),q=async t=>{try{if(A(!0),void 0===r){C({title:"Error",description:"Thumbnail is required",variant:"destructive"}),A(!1);return}let s=(await Promise.all(e.map(async e=>{try{console.log(`Starting upload for image: ${e.alt}`);let t=await (0,f.cV)(e.file);if("string"==typeof t)return console.log(`Successfully uploaded image: ${e.alt}`),{alt:e.alt,src:t};return console.error(`Failed to upload image: ${e.alt}`,t),C({title:"Error",description:`Failed to upload image "${e.alt}"`,variant:"destructive"}),A(!1),null}catch(t){return console.error(`Error uploading image "${e.alt}":`,t),C({title:"Error",description:`Failed to upload image "${e.alt}"`,variant:"destructive"}),A(!1),null}}))).filter(e=>null!==e);if(s.length!==e.length){A(!1);return}console.log("uploaded",s);let o=t.content;o=o.replace(/IMG<([^,]+)(?:,\s*(\d+))?(?:,\s*(\d+))?>/g,(e,t,r,o)=>{let n=s.find(e=>e.alt===t);return n?`IMG<${t},${n.src}${r?`,${r}`:""}${o?`,${o}`:""}>`:(C({title:"Error",description:`Image with alt "${t}" not found`,variant:"destructive"}),e)});let n=await (0,f.cV)(r.file);if("string"==typeof n);else{console.error("Failed to upload thumbnail:",n),C({title:"Error",description:"Failed to upload thumbnail",variant:"destructive"}),A(!1);return}let l=(0,f.QH)(o);console.log({...t,finalUploadedImages:s,convertedContent:l}),console.log({blogId:t.blogId,title:t.title,content:l,tags:t.tags}),await (0,j.ly)({blogId:t.blogId,title:t.title,content:l,tags:t.tags,contentOriginal:t.content}).then(e=>{if("error"in e){C({title:"Error",description:"Something went wrong while creating the blog.",variant:"destructive"}),A(!1);return}C({title:"Blog Created",description:"Your blog has been successfully created!"})}).then(()=>{s.forEach(async e=>{await (0,w.i7)(t.blogId,{src:e.src,imageId:e.alt,isThumbnail:!1}).then(e=>{"error"in e&&(C({title:"Error",description:"Something went wrong while creating the blog images.",variant:"destructive"}),(0,j.yb)(t.blogId).then(e=>{"error"in e&&C({title:"Error",description:"Something went wrong while deleting the blog.",variant:"destructive"})}))})}),(0,w.i7)(t.blogId,{src:n,imageId:r.alt,isThumbnail:!0}).then(e=>{"error"in e&&(C({title:"Error",description:"Something went wrong while creating the blog thumbnail.",variant:"destructive"}),(0,j.yb)(t.blogId).then(e=>{"error"in e&&C({title:"Error",description:"Something went wrong while deleting the blog.",variant:"destructive"})}))})}).finally(()=>{A(!1)})}catch(e){console.error("Error in onSubmit:",e),C({title:"Error",description:"Something went wrong while creating the blog.",variant:"destructive"})}};return(0,s.jsx)("div",{className:"w-full ",children:(0,s.jsxs)(g.lV,{...P,children:[(0,s.jsx)("form",{onSubmit:P.handleSubmit(q),className:"space-y-8 p-4",children:(0,s.jsxs)("div",{className:"flex space-x-10",children:[(0,s.jsxs)("div",{className:"w-3/4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(g.zB,{control:P.control,name:"title",render:({field:e})=>(0,s.jsxs)(g.eI,{className:"flex-1",children:[(0,s.jsx)(g.lR,{children:"Blog Name"}),(0,s.jsx)(g.MJ,{children:(0,s.jsx)(h.p,{placeholder:"Enter blog name",...e})}),(0,s.jsx)(g.C5,{})]})}),(0,s.jsx)(g.zB,{control:P.control,name:"blogId",render:({field:e})=>(0,s.jsxs)(g.eI,{className:"flex-1",children:[(0,s.jsx)(g.lR,{children:"Blog ID"}),(0,s.jsx)(g.MJ,{children:(0,s.jsx)(h.p,{placeholder:"Enter blog ID",...e})}),(0,s.jsx)(g.C5,{})]})})]}),(0,s.jsx)(g.zB,{control:P.control,name:"content",render:({field:e})=>(0,s.jsxs)(g.eI,{children:[(0,s.jsxs)(g.lR,{className:"flex w-full justify-between items-center",children:[(0,s.jsx)("p",{children:"Content"}),(0,s.jsxs)(c.lG,{children:[(0,s.jsx)(c.zM,{children:(0,s.jsx)("p",{className:"hover:underline",children:"Help"})}),(0,s.jsxs)(c.Cf,{className:"max-w-4xl max-h-[80vh]",children:[(0,s.jsx)(c.c7,{children:(0,s.jsx)(c.L3,{children:"Blog Content Guideline"})}),(0,s.jsx)(v.default,{src:"/images/guidline.png",alt:"guidline",width:800,height:600})]})]})]}),(0,s.jsx)(g.MJ,{children:(0,s.jsx)(i.T,{placeholder:"Write your blog content here...",className:"min-h-[300px]",...e})}),(0,s.jsx)(g.C5,{})]})})]}),(0,s.jsxs)("div",{className:"w-1/4 space-y-4",children:[(0,s.jsx)("p",{className:"text-lg font-bold",children:"Choose images for content"}),(0,s.jsx)(m.A,{uploadedImages:e,onUpload:e=>{let r=URL.createObjectURL(e),s=e.name.split(".").slice(0,-1).join(".");t(t=>[...t,{alt:s,src:r,file:e}])},onDelete:e=>{t(t=>{let r=t.filter(t=>t.src!==e);return URL.revokeObjectURL(e),r})},onUpdateAlt:(e,r)=>{t(t=>t.map(t=>t.alt===e?{...t,alt:r}:t))},isEditing:!0}),(0,s.jsxs)(c.lG,{children:[(0,s.jsx)(c.zM,{asChild:!0,children:(0,s.jsx)(a.$,{onClick:()=>{let t=P.getValues("content");t=t.replace(/IMG<([^,]+)(?:,\s*(\d+))?(?:,\s*(\d+))?>/g,(t,r,s,o)=>{let n=e.find(e=>e.alt===r);return n?`IMG<${r},${n.src}${s?`,${s}`:""}${o?`,${o}`:""}>`:(C({title:"Error",description:`Image with alt "${r}" not found`,variant:"destructive"}),t)}),$((0,f.QH)(t))},className:"w-full",children:"Preview"})}),(0,s.jsxs)(c.Cf,{className:"max-w-4xl max-h-[80vh]",children:[(0,s.jsx)(c.c7,{children:(0,s.jsx)(c.L3,{children:"Blog Preview"})}),(0,s.jsx)(d.F,{className:"h-full max-h-[calc(80vh-4rem)]",children:(0,s.jsx)(x.A,{content:E})})]})]}),(0,s.jsx)("p",{className:"text-lg font-bold",children:"Choose thumbnail"}),(0,s.jsx)(m.A,{uploadedImages:r?[r]:[],onUpload:e=>{let t=URL.createObjectURL(e);I({alt:e.name.split(".").slice(0,-1).join("."),src:t,file:e})},onDelete:()=>I(void 0),onUpdateAlt:(e,t)=>{I(e=>({...e,alt:t}))},isMultiple:!1,isEditing:!0}),(0,s.jsx)(g.zB,{control:P.control,name:"tags",render:({field:e})=>(0,s.jsxs)(g.eI,{children:[(0,s.jsx)(g.lR,{children:"Tags"}),(0,s.jsx)(g.MJ,{children:(0,s.jsx)(b.A,{tags:e.value,setTags:e.onChange,isEditing:!0})}),(0,s.jsx)(g.C5,{})]})}),(0,s.jsx)(a.$,{type:"submit",className:`${N?"bg-[#030391]/20 cursor-not-allowed hover:bg-[#030391]/20 active:bg-[#030391]/20":"bg-sub hover:bg-main/90 active:bg-main/95"} w-full relative`,children:N?(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-gray-900"})}):"Create Blog"})]})]})}),(0,s.jsx)(p.Toaster,{})]})})}},29695:(e,t,r)=>{"use strict";r.d(t,{Dm:()=>n,Xm:()=>o,Yb:()=>a,ly:()=>l,yb:()=>i});var s=r(79828);let o=async()=>{try{let e=await s.A.get("api/blog/routes.php");return console.log("Backend Response:",e.data),e.data.data.map(e=>({blogId:e.blogId,title:e.title,content:e.content,tags:JSON.parse(e.tags),posted:e.posted,contentOriginal:e.content_original}))}catch(e){return console.log("Error:",e),{error:"An error occurred while fetching blogs"}}},n=async e=>{try{let t=await s.A.get(`api/blog/routes.php?blogId=${e}`);console.log("Backend Response:",t.data);let{title:r,content:o,tags:n,posted:l,content_original:a}=t.data.data;return{blogId:e,title:r,content:o,tags:JSON.parse(n),posted:l,contentOriginal:a}}catch(e){return console.log("Error:",e),{error:"An error occurred while fetching blog"}}},l=async e=>{try{let t=await s.A.post("api/blog/routes.php",e);return console.log("Backend Response:",t.data),{message:t.data.message}}catch(e){return console.log("Error:",e),{error:"An error occurred while creating blog"}}},a=async(e,t)=>{try{let r=await s.A.put(`api/blog/routes.php?blogId=${e}`,t);return console.log("Backend Response:",r.data),{message:r.data.message}}catch(e){return console.log("Error:",e),{error:"An error occurred while updating blog"}}},i=async e=>{try{let t=await s.A.delete(`api/blog/routes.php?blogId=${e}`);return console.log("Backend Response:",t.data),{message:t.data.message}}catch(e){return console.log("Error:",e),{error:"An error occurred while deleting blog"}}}},34584:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"W:\\\\web\\\\shop-co3049-fe\\\\app\\\\admin\\\\(main)\\\\blogs\\\\create\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"W:\\web\\shop-co3049-fe\\app\\admin\\(main)\\blogs\\create\\page.tsx","default")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,9798,7180,4388,5103,9749,8310,6371,3998,6107,72,2130],()=>r(33737));module.exports=s})();